!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(t=>setTimeout(t,10));var t;t=async function(){new Spicetify.ContextMenu.Item("Играть по рейтингу",i,a,'<svg role="img" height="16" width="16" viewBox="0 0 20 20" fill="currentColor"><path d="M3.67 8.67h14V11h-14V8.67zm0-4.67h14v2.33h-14V4zm0 9.33H13v2.34H3.67v-2.34zm11.66 0v7l5.84-3.5-5.84-3.5z"></path></svg>').register()},(async()=>{await t()})();async function i(t){t=await async function(t){t=await Spicetify.GraphQL.Request(Spicetify.GraphQL.Definitions.queryArtistDiscographyAll,{uri:t.uri,local:"en",limit:t.discography.all.totalCount,offset:0});return t.data.artistUnion}(await async function(t){t=await Spicetify.GraphQL.Request(Spicetify.GraphQL.Definitions.queryArtistDiscographyOverview,{locale:"",uri:t[0],includePrerelease:!0});return t.data.artistUnion}(t));let i=[];var a=[];for(const e of t.discography.all.items)for(const r of e.releases.items)a.push(async function(t){t=await Spicetify.GraphQL.Request(Spicetify.GraphQL.QueryDefinitions.getAlbum,{locale:"",offset:0,limit:50,uri:t.uri});return t.data.albumUnion}(r));for(const n of await Promise.all(a))i=i.concat(n.tracks.items);t=(i=function(t){let e=new Map;return t.map(function(t){var i,a=t.track.name+"|"+t.track.playcount;e.has(a)||e.set(a,t),e.has(a)&&(i=e.get(a).track.duration.totalMilliseconds-t.track.duration.totalMilliseconds,1e4<Math.abs(i))&&e.set(a,t)}),Array.from(e.values())}(i)).sort(function(t,i){return i.track.playcount-t.track.playcount});!async function(t){t=t.map(t=>({uri:t.track.uri}));await Spicetify.Platform.PlayerAPI.clearQueue(),await Spicetify.Platform.PlayerAPI.addToQueue(t).catch(t=>{console.error("Failed to add to queue",t),Spicetify.showNotification("Ошибка добавление треков в очередь.")})}(t)}function a(t){return!(1<t.length)&&Spicetify.URI.fromString(t[0]).type===Spicetify.URI.Type.ARTIST}}();